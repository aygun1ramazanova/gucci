define(["jquery","eventDispatcher","ajaxConfig","handlebars","imageLoader"],function(e,a,t,s,i){function n(){l(),r()}function r(){u||(e(window).on("saved-item.save",null,e.proxy(d)),e(window).on("saved-item.remove",null,e.proxy(d)),e(window).on("saved-items-flyout.loaded",function(){f=e(".header-nav-favorites-list"),i.loadImage(f)}))}function d(e,a){o(a.data,a.itemCount)}function o(a,t){var s=e(".header-nav-child-favorites"),n=e(".header-nav-favorites-link"),r=e(".header-nav-child-favorites-wrapper .empty"),d=e(".header-nav-parent-favorites");f.length<=1&&(f=e(h+" .header-nav-favorites-list")),v(t),f.find("li").remove(),a.length?e.each(a,function(e,a){var t=y(a);f.append(t),s.removeClass("box-favorites-empty"),n.removeClass("hide"),r.addClass("hide"),d.removeClass(m)}):(s.addClass("box-favorites-empty"),n.addClass("hide"),r.removeClass("hide"),d.addClass(m)),l(a.length),f.scrollTop(0),i.loadImage(f)}function v(a){var t,s=a,i="header-nav-parent-favorites-empty",n=".saved-items-wrapper",r="saved-items-empty";s>0?(t=s,e(h+" .header-nav-parent-favorites").removeClass(i),e(n).removeClass(r)):(t="",s=0,e(h+" .header-nav-parent-favorites").addClass(i),e(n).addClass(r)),e("#header-main, #mobile-menu").find(p).html(t)}function l(){var a=e(".header-nav-favorites-item").length,t="header-nav-child-favorites-empty",s="header-nav-child-favorites-small",i="header-nav-child-favorites-single",n=e("div#header-nav-favorites");switch(n.removeClass(t+" "+i+" "+s),a=c,e(".header-nav-favorites-item").length){case 0:n.addClass(t);break;case 1:n.addClass(i);break;case 2:n.addClass(s)}}var h="#header-nav-favorites",m="header-nav-parent-favorites-empty",f=e(".header-nav-favorites-list"),c=0,p="[data-saved-items-count]",u=e("#header-main-checkout").length>0;if(!u)var C=e("#saved-item-flyout-template").html(),y=s.compile(C);return{load:function(){function e(){}n(),a.dispatchAndListen("savedItemsFlyout",e)},setFavoritesHeight:l}});