define(["jquery","eventDispatcher","overlay","formEndpointValidation","ajaxConfig","ajaxLoader","handlebars","accordion","textareaCharsCounter"],function(e,a,r,i,n,o,s,t,l){function m(){e(window).on("overlay.loaded",function(){b=e("#share-by-email-overlay-ajax-form"),p=e("#share-by-email-send-more-friends"),p=e("#share-by-email-send-more-friends, #share-by-email-send-more-friends-ajax"),w=e(".share-by-email-send-more-friends-accordion-button"),i.newInstance(b,c),m(),l.load()}),t.setAccordians(),p.off("change").on("change",function(){y(),h(j,f)}),i.newInstance(v,c),e(".js-wishlistsharemobile").removeClass("is-loading").on("click",function(a){a.preventDefault();var i=e(this);i.hasClass("is-loading")||e.ajax({url:e(".js-wishlistsharemobile").data("wishlistcodeAjaxEndpoint"),data:{code:e(".js-wishlistsharemobile").data("wishlistcode")},beforeSend:function(){i.addClass("is-loading")},success:function(a){i.removeClass("is-loading"),window.location=e(".js-wishlistsharemobile").attr("href")+"%0A"+encodeURIComponent(a),r.close("#top-right-share")}})})}function c(a){var r=b.find('input[name="type"]').val();switch(r){case"WISHLIST":case"PRODUCT":case"STORE":switch(a.status){case"ok":e.event.trigger({type:"formOk",form:this.$form});var i=e(".share-by-email-overlay-form"),n=e(".share-by-email-confirmation-container");e(i).fadeOut(),e(n).fadeIn();break;default:d(a)}break;default:d(a)}}function d(e){return r.close("#share-by-email-overlay"),u(),e}function f(){return e(this).closest(".accordion-item").hasClass("_open")}function h(e,a){a?e.attr("required","required"):(e.removeAttr("required"),e.removeClass("error").attr("aria-invalid","false"),e.next().remove())}function y(){w.click()}function u(){e('#share-by-email-overlay-form input[name="recipientName1"]').val(""),e('#share-by-email-overlay-form input[name="recipientEmail1"]').val(""),e('#share-by-email-overlay-form input[name="recipientName2"]').val(""),e('#share-by-email-overlay-form input[name="recipientEmail2"]').val(""),e('#share-by-email-overlay-form input[name="recipientName3"]').val(""),e('#share-by-email-overlay-form input[name="recipientEmail3"]').val(""),e('#share-by-email-overlay-form textarea[name="comment"]').val("")}var v=e("#share-by-email-overlay-form"),b=e("#share-by-email-overlay-ajax-form"),p=e("#share-by-email-send-more-friends, #share-by-email-send-more-friends-ajax"),w=e(".share-by-email-send-more-friends-accordion-button"),j=e(".share-by-email-overlay-form-container.accordion-drawer input");e(document).find("title").text(),window.location.href,e("#top-right-share"),e(".share-by-email-overlay-form-send-button"),e(".share-by-email-overlay");return{load:function(){function e(){}m(),a.dispatchAndListen("overlayShareByEmail",e)}}});