define(["jquery","eventDispatcher","formValidationWithObject","ajaxConfig","ajaxLoader"],function(e,n,t,a,i){function o(){t.newFormValidate(e(u)),e(".sign-in-sa-content input").bind("change",function(){void 0!==e(this).val()&&""!==e(this).val()&&e(this).removeClass("error")}),e(c).bind("keyup",d),e(c).change(),e(".full-ssa-logged-out-cta").bind("click",s)}function s(){e(this).closest("form").submit()}function r(n){var t=".js-no-eaau",a="#loginSAForm",i=e(v).data("eaau-label"),o=e(v).data("normal-label");"show"===n&&(e(t).attr("hidden",!1),e(t+" input").attr("required","required"),e(a).attr("action",m),e(v).html(o)),"hide"===n&&(e(t).attr("hidden",!0),e(t+" input").removeAttr("required"),e(a).attr("action",S),e(v).html(i))}function l(n){var t="_disabled";"able"===n?e(v).removeClass(t):e(v).addClass(t)}function d(){var n={email:e(this).val()};if(l("disable"),""!==n.email){var t=i.endPointAccess(f,n,"POST");t.done(function(n){var t=n;if(t.eaau)r("hide");else if(r("show"),h.find("option").not('[value=""]').remove(),(void 0!=t.stores||null!=t.stores)&&t.stores.length>0){var a=1==t.stores.length;t.stores.map(function(n){var t=n.name?n.name:n.storeCode;e("<option>",{value:n.storeCode,selected:a}).text(t).appendTo(h)})}l("able")}),t.fail(function(e,n,t){console.error("The following error occurred: "+e.status+" "+n,t),location.reload()})}}var u="#loginSAForm",c=".sign-in-form input[name=email]",f="SALES_ASSISTANT_STORES",m=a.config["SALES-ASSISTANT-SIGN-IN"],S=a.config["SALES-ASSISTANT-SIGN-IN-EAAU"],h=e("#sales-assistant-stores"),v=".sign-in-form .sign-button";return{load:function(){function t(){}o(),e(u).removeClass("hide"),n.dispatchAndListen("signInSalesAssistant",t)}}});